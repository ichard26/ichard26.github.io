<!doctype html><html lang=en-ca dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>What's new in pip 24.3 | Richard Si</title>
<meta name=keywords content="pip,release"><meta name=description content="pip 24.3 is a small release with a truststore bugfix, error QoL improvements, and one minor deprecation of noncompliant wheel filenames."><meta name=author content><link rel=canonical href=https://ichard26.github.io/blog/2024/11/whats-new-in-pip-24.3/><link crossorigin=anonymous href=/assets/css/stylesheet.2693a403f5986ba233be02cd316c658d98624f928efcdb14e99e8064cdd03997.css integrity="sha256-JpOkA/WYa6IzvgLNMWxljZhiT5KO/NsU6Z6AZM3QOZc=" rel="preload stylesheet" as=style><link rel=icon href=https://ichard26.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ichard26.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ichard26.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ichard26.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ichard26.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en-ca href=https://ichard26.github.io/blog/2024/11/whats-new-in-pip-24.3/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script defer data-domain=ichard26.github.io src=https://webstats.internal.floralily.dev/js/script.outbound-links.js></script><meta name=google-site-verification content="4PNzC3Db8jI_wn9D8lPdAh4B0skrLZHNbQBgVF1XtAo"><meta property="og:url" content="https://ichard26.github.io/blog/2024/11/whats-new-in-pip-24.3/"><meta property="og:site_name" content="Richard Si"><meta property="og:title" content="What's new in pip 24.3"><meta property="og:description" content="pip 24.3 is a small release with a truststore bugfix, error QoL improvements, and one minor deprecation of noncompliant wheel filenames."><meta property="og:locale" content="en-ca"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-11-14T00:00:00-05:00"><meta property="article:modified_time" content="2024-11-17T00:00:00-05:00"><meta property="article:tag" content="Pip"><meta property="article:tag" content="Release"><meta name=twitter:card content="summary"><meta name=twitter:title content="What's new in pip 24.3"><meta name=twitter:description content="pip 24.3 is a small release with a truststore bugfix, error QoL improvements, and one minor deprecation of noncompliant wheel filenames."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://ichard26.github.io/blog/"},{"@type":"ListItem","position":2,"name":"What's new in pip 24.3","item":"https://ichard26.github.io/blog/2024/11/whats-new-in-pip-24.3/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"What's new in pip 24.3","name":"What\u0027s new in pip 24.3","description":"pip 24.3 is a small release with a truststore bugfix, error QoL improvements, and one minor deprecation of noncompliant wheel filenames.","keywords":["pip","release"],"articleBody":"On October 27, 2024, the pip team released pip 24.3. This release was a significantly smaller release with only a handful of minor fixes and improvements.\nThis write-up also includes the hotfixes included in pip 24.3.1 released on the same day.\nThank you to Damian Shaw, Hugo van Kemenade, and Stéphane Bidoul for reviewing the draft of this write-up.\nPSA: Legacy editable installs are deprecated TL;DR, don’t panic. The -e option is not deprecated, but the way it works under the hood will change, potentially necessitating changes to how your project is packaged.\nIf you aren’t aware, since pip 24.2, legacy editable installs are deprecated and support is scheduled for removal in pip 25.0 in the new year (at the time of writing).\npip install -e temp/pip-test-package Obtaining file:///home/ichard26/dev/oss/pip/temp/pip-test-package Preparing metadata (setup.py) ... done Installing collected packages: version_pkg DEPRECATION: Legacy editable install of version_pkg==0.1 from file:///home/ichard26/dev/oss/pip/temp/pip-test-package (setup.py develop) is deprecated. pip 25.0 will enforce this behaviour change. A possible replacement is to add a pyproject.toml or enable --use-pep517, and use setuptools \u003e= 64. If the resulting installation is not behaving as expected, try using --config-settings editable_mode=compat. Please consult the setuptools documentation for more information. Discussion can be found at https://github.com/pypa/pip/issues/11457 Running setup.py develop for version_pkg Successfully installed version_pkg-0.1 Editable installs are not deprecated, but pip will stop running the setuptools specific setup.py file under the hood. Instead, pip is transitioning to exclusively using the standardized mechanism to request an editable install from the project’s backend defined in PEP 660.\nIf you’re confused, don’t worry. The implementation details are admittedly a bit complex, but all you need to know is that:\nYou will see this deprecation notice if the package you are trying to install has setuptools as its build backend AND: EITHER this package does not have a valid build system declaration, thus pip will opt-out of the modern mechanisms and run setup.py directly as required OR this package’s build system declaration explicitly requests a version setuptools older than version 64 which lacks support for the modern editable installation mechanism (PEP 660) The easiest way to address the deprecation is to add a pyproject.toml file that declares your package’s build system to be setuptools (see the guide “How to modernize a setup.py based project?” for more details) You can keep your setup.py file. It’s a configuration file for setuptools, and setuptools still supports it. pip simply won’t be running it directly anymore, delegating to setuptools (see the discussion “Is setup.py deprecated?” for more details). If you wish, you can migrate your packaging setup to pyproject.toml entirely, but this isn’t necessary For more advice, please see the issue tracking this deprecation and this comment. You can also read my write-up on pip 24.2 which discusses the context behind the deprecation.\nQoL improvements Recursive requirement files are now detected Imagine you had a requirement file that recursively included itself:\n-r requirements.txt If you ran pip install -r requirements.txt, you’d get a nasty crash as pip kept following the loop until it reached the recursion limit:\nERROR: Exception: Traceback (most recent call last): [trimmed...] File \"/home/ichard26/dev/oss/pip/src/pip/_internal/cli/req_command.py\", line 255, in get_requirements for parsed_req in parse_requirements( File \"/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py\", line 151, in parse_requirements for parsed_line in parser.parse(filename, constraint): File \"/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py\", line 332, in parse yield from self._parse_and_recurse(filename, constraint) File \"/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py\", line 361, in _parse_and_recurse yield from self._parse_and_recurse(req_path, nested_constraint) File \"/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py\", line 361, in _parse_and_recurse yield from self._parse_and_recurse(req_path, nested_constraint) File \"/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py\", line 361, in _parse_and_recurse yield from self._parse_and_recurse(req_path, nested_constraint) [Previous line repeated 974 more times] File \"/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py\", line 337, in _parse_and_recurse for line in self._parse_file(filename, constraint): [trimmed...] RecursionError: maximum recursion depth exceeded This example is admittedly a bit contrived, but it can happen if you’re referencing requirement files in a chain and forget what you’ve already included. Now, pip will detect this loop and raise a proper error.\npip install -r test.txt ERROR: /home/ichard26/dev/oss/pip/test.txt recursively references itself in test.txt This was contributed by Kuntal Majumder (@hellozee) in PR #12877. ✨\n(There was a bug where the error would be raised too often, even when no actual recursion was present. This was promptly addressed in pip 24.3.1.)\nInstalled packages with broken dependency metadata now raise a proper error Since pip 24.1, non standard-compliant versions or dependency specifiers are unsupported. While pip will ignore packages with this legacy invalid metadata when possible, in other cases, the offending package had to be uninstalled to allow pip to function.\nUnfortunately, similar to the issue above, pip would just crash and leave the user a horrible traceback in these cases.\npip install celery Requirement already satisfied: celery in ./venv/lib/python3.12/site-packages (4.4.7) ERROR: Exception: [trimmed...] File \"/home/ichard26/dev/oss/pip/src/pip/_internal/resolution/resolvelib/candidates.py\", line 401, in iter_dependencies for r in self.dist.iter_dependencies(): File \"/home/ichard26/dev/oss/pip/src/pip/_internal/metadata/importlib/_dists.py\", line 215, in iter_dependencies req = get_requirement(req_string.strip()) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File \"/home/ichard26/dev/oss/pip/src/pip/_internal/utils/packaging.py\", line 45, in get_requirement return Requirement(req_string) ^^^^^^^^^^^^^^^^^^^^^^^ File \"/home/ichard26/dev/oss/pip/src/pip/_vendor/packaging/requirements.py\", line 38, in __init__ raise InvalidRequirement(str(e)) from e pip._vendor.packaging.requirements.InvalidRequirement: Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier pytz (\u003edev) ~^ To address this, a new diagnostic error has been added when encountering a broken pre-installed package.\npip install celery Requirement already satisfied: celery in ./venv/lib/python3.12/site-packages (4.4.7) error: invalid-installed-package × Cannot process installed package celery 4.4.7 in '/home/ichard26/dev/oss/pip/venv/lib/python3.12/site-packages' because it has an invalid requirement: │ Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier │ pytz (\u003edev) │ ^ ╰─\u003e Starting with pip 24.1, packages with invalid requirements can not be processed. hint: To proceed this package must be uninstalled. Admittedly, the error is a bit hard to read, but with time, pip’s errors should improve. In the interim, you can quickly tell what package is causing the problem (celery) and how to fix it (uninstall it).\nmacOS 10.12 is resupported If you’re part of the tiny group that still uses modern pip on macOS 10.12, you would’ve learned first-hand that truststore did not support macOS 10.12, breaking pip. Good news though, pip 24.3 restores support by vendoring in an updated version of truststore that uses older macOS APIs when needed.\nThis brings the pip project one step closer to being able to use system HTTPS certificates when possible, all without blowing up in odd situations. There are still some known issues with private certificates, however.\nInvalid wheel filenames are deprecated Note: Unless you use ancient packages before the advent of modern packaging tooling AND are incredibly unlucky, this deprecation will NOT affect you. This is mostly for those interested in the packaging nitty gritty.\nIf you have any sort of familiarity with Python packaging, you’d have heard of wheels. Wheels are a binary distribution format for Python packages. They are pre-built, which makes installing them particularly easy: just unzip them and copy the contents to the site-packages directory.1\nSomething you might not know is that their filenames follow a certain structure. This enables installers to extract essential metadata without inspecting the wheel’s contents. As an example, let’s take a look at the newest wheel for pip.\npip-24.3.1-py3-none-any.whl Here, we know three pieces of information immediately:\npip is the package name 24.3.1 is the version py3-none-any is the compatibility tag. I went over compatibility tags in my previous pip write-up, but essentially, py3-none-any is code for this package supports “any Python 3 version”, “any Python ABI”, and “any architecture.” Unfortunately, some wheels out in the wild have improper names, such as:\ntranslate_toolkit-1.9.0_pinterest3-py27-none-any.whl j2cli-0.3.0_1-py2-none-any.whl password_strength-0.0.1_1-py2-none-any.whl According to the version specifier standard, underscores can be used to separate the release segment from any pre/post/development release segments. However, they cannot be used to separate an implicit post-release.\nIn other words, 1.2.0_post1 (explicit) is valid, but 1.2.0_1 (implicit) is not.2\nFor historical reasons, pip has accepted wheels with this error. This is inconsistent and confusing, thus starting with pip 24.3, these wheels are no longer supported.\nFrankly, virtually no packages today have this issue, so you can forget this deprecation even exists3, but it is a perfect opportunity to learn about the complexity found in Python packaging. Many things may look easy in packaging, but often they are not :)\nOther changes iOS wheels are provisionally supported: pip will now recognize and accept iOS tagged wheels, although whether pip properly supports them is something I don’t know. Installing pip in editable mode in a virtual environment on Windows doesn’t result in a data race crash anymore The --target option is ignored while pip prepares a build environment during installation, which often caused confusing crashes when it was configured globally in a pip configuration file or via the PIP_TARGET environment variable. Of course, it’s not this simple in reality, but there is no “build step” involved which makes them trivial compared to source distributions (typically .tar.gz). ↩︎\nTo declare a post-release without the post prefix, you must use the - separator, e.g. 1.2.0-1. Naturally, this raises the question of what to do when this version is placed in the wheel filename as dashes are reserved as wheel filename separators. The answer is that the version should be normalized when placed in a wheel filename, and fortunately for us, 1.2.0-1 normalizes to 1.2.0.post1. ↩︎\nWhile reviewing the deprecation PR, I scraped the index pages for the top 8000 PyPI packages and could only find 4 ancient wheels that have this quirk in their filename. ↩︎\n","wordCount":"1516","inLanguage":"en-ca","datePublished":"2024-11-14T00:00:00-05:00","dateModified":"2024-11-17T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ichard26.github.io/blog/2024/11/whats-new-in-pip-24.3/"},"publisher":{"@type":"Person","name":"Richard Si","logo":{"@type":"ImageObject","url":"https://ichard26.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ichard26.github.io/ accesskey=h title="Richard Si (Alt + H)">Richard Si</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ichard26.github.io/about/ title=About><span>about</span></a></li><li><a href=https://ichard26.github.io/blog/ title=Writing><span>writing</span></a></li><li><a href=https://ichard26.github.io/privacy/ title="Privacy Statement"><span>privacy</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">What's new in pip 24.3</h1><div class=post-description>pip 24.3 is a small release with a truststore bugfix, error QoL improvements, and one minor deprecation of noncompliant wheel filenames.</div><div class=post-meta><span class=post-date title='Posted on 2024-11-14 00:00:00 -0500 EST'>November 14, 2024</span><span class=delimiter>&nbsp;·&nbsp;</span><span class=last-modified title='Updated on 2024-11-17 00:00:00 -0500 EST'>Updated on November 17, 2024</span><span class=delimiter>&nbsp;·&nbsp;</span>8 minutes</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#psa-legacy-editable-installs-are-deprecated aria-label="PSA: Legacy editable installs are deprecated">PSA: Legacy editable installs are deprecated</a></li><li><a href=#qol-improvements aria-label="QoL improvements">QoL improvements</a><ul><li><a href=#recursive-requirement-files-are-now-detected aria-label="Recursive requirement files are now detected">Recursive requirement files are now detected</a></li><li><a href=#installed-packages-with-broken-dependency-metadata-now-raise-a-proper-error aria-label="Installed packages with broken dependency metadata now raise a proper error">Installed packages with broken dependency metadata now raise a proper error</a></li></ul></li><li><a href=#macos-1012-is-resupported aria-label="macOS 10.12 is resupported">macOS 10.12 is resupported</a></li><li><a href=#invalid-wheel-filenames-are-deprecated aria-label="Invalid wheel filenames are deprecated">Invalid wheel filenames are deprecated</a></li><li><a href=#other-changes aria-label="Other changes">Other changes</a></li></ul></div></details></div><div class=post-content><p>On October 27, 2024, <a href=https://discuss.python.org/t/announcement-pip-24-3-release/69350 target=_blank>the pip team released pip 24.3</a>. This release was a significantly
smaller release with only a handful of minor fixes and improvements.</p><p>This write-up also includes the hotfixes included in pip 24.3.1 released on the same day.</p><p>Thank you to Damian Shaw, Hugo van Kemenade, and Stéphane Bidoul for reviewing the draft
of this write-up.</p><h2 id=psa-legacy-editable-installs-are-deprecated>PSA: Legacy editable installs are deprecated<a hidden class=anchor aria-hidden=true href=#psa-legacy-editable-installs-are-deprecated>#</a></h2><blockquote><p>TL;DR, <strong>don&rsquo;t panic</strong>. The <code>-e</code> option is <em>not</em> deprecated, but the way it works under
the hood will change, potentially necessitating changes to how your project is packaged.</p></blockquote><p>If you aren&rsquo;t aware, since pip 24.2, <strong>legacy</strong> editable installs are deprecated and
<strong>support is scheduled for removal in pip 25.0 in the new year</strong> (at the time of writing).</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-console data-lang=console><span style=display:flex><span>pip install -e temp/pip-test-package
</span></span><span style=display:flex><span>Obtaining file:///home/ichard26/dev/oss/pip/temp/pip-test-package
</span></span><span style=display:flex><span>  Preparing metadata (setup.py) ... done
</span></span><span style=display:flex><span>Installing collected packages: version_pkg
</span></span><span style=display:flex;background-color:#3c3d38><span>  DEPRECATION: Legacy editable install of version_pkg==0.1 from file:///home/ichard26/dev/oss/pip/temp/pip-test-package (setup.py develop) is deprecated. pip 25.0 will enforce this behaviour change. A possible replacement is to add a pyproject.toml or enable --use-pep517, and use setuptools &gt;= 64. If the resulting installation is not behaving as expected, try using --config-settings editable_mode=compat. Please consult the setuptools documentation for more information. Discussion can be found at https://github.com/pypa/pip/issues/11457
</span></span><span style=display:flex><span>  Running setup.py develop for version_pkg
</span></span><span style=display:flex><span>Successfully installed version_pkg-0.1
</span></span></code></pre></div><p>Editable installs are <em>not</em> deprecated, but pip will stop running the setuptools specific
<code>setup.py</code> file under the hood. Instead, pip is transitioning to exclusively using the
standardized mechanism to request an editable install from the project&rsquo;s backend defined
in <a href=https://peps.python.org/pep-0660/ target=_blank>PEP 660</a>.</p><p>If you&rsquo;re confused, don&rsquo;t worry. The implementation details are admittedly a bit complex,
but all you need to know is that:</p><ul><li>You will see this deprecation notice <strong>if the package</strong> you are trying to install has
<strong>setuptools as its build backend AND</strong>:<ul><li><strong>EITHER this package does not have a valid <a href=https://packaging.python.org/en/latest/specifications/pyproject-toml/#declaring-build-system-dependencies-the-build-system-table target=_blank>build system declaration</a></strong>, thus pip
will opt-out of the modern mechanisms and run <code>setup.py</code> directly as required</li><li><strong>OR this package’s build system declaration explicitly requests a version setuptools
older than version 64</strong> which lacks support for the modern editable installation
mechanism (PEP 660)</li></ul></li><li>The easiest way to address the deprecation is to <strong>add a <code>pyproject.toml</code> file that
declares your package&rsquo;s build system to be setuptools</strong> (see the guide
<a href=https://packaging.python.org/en/latest/guides/modernize-setup-py-project/ target=_blank>&ldquo;How to modernize a setup.py based project?&rdquo;</a> for more details)</li><li><strong>You can keep your <code>setup.py</code> file.</strong> It&rsquo;s a configuration file for setuptools, and
setuptools still supports it. pip simply won&rsquo;t be running it directly anymore,
delegating to setuptools (see the discussion <a href=https://packaging.python.org/en/latest/discussions/setup-py-deprecated/ target=_blank>&ldquo;Is setup.py deprecated?&rdquo;</a> for more
details).<ul><li>If you wish, you can migrate your packaging setup to <code>pyproject.toml</code> entirely, but
this isn&rsquo;t necessary</li></ul></li></ul><p><strong>For more advice, please <a href=https://github.com/pypa/pip/issues/11457 target=_blank>see the issue tracking this deprecation</a> and
<a href=https://github.com/pypa/pip/issues/11457#issuecomment-2439645125 target=_blank>this comment</a>.</strong> You can also read my <a href=/blog/2024/08/whats-new-in-pip-24.2/>write-up on pip 24.2</a> which discusses the context
behind the deprecation.</p><h2 id=qol-improvements>QoL improvements<a hidden class=anchor aria-hidden=true href=#qol-improvements>#</a></h2><h3 id=recursive-requirement-files-are-now-detected>Recursive requirement files are now detected<a hidden class=anchor aria-hidden=true href=#recursive-requirement-files-are-now-detected>#</a></h3><p>Imagine you had a requirement file that recursively included itself:</p><pre tabindex=0><code>-r requirements.txt
</code></pre><p>If you ran <code>pip install -r requirements.txt</code>, you&rsquo;d get a nasty crash as pip kept
following the loop until it reached the recursion limit:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>ERROR: Exception:
</span></span><span style=display:flex><span>Traceback (most recent call last):
</span></span><span style=display:flex><span>[trimmed...]
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/cli/req_command.py&#34;, line 255, in get_requirements
</span></span><span style=display:flex><span>    for parsed_req in parse_requirements(
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py&#34;, line 151, in parse_requirements
</span></span><span style=display:flex><span>    for parsed_line in parser.parse(filename, constraint):
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py&#34;, line 332, in parse
</span></span><span style=display:flex><span>    yield from self._parse_and_recurse(filename, constraint)
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py&#34;, line 361, in _parse_and_recurse
</span></span><span style=display:flex><span>    yield from self._parse_and_recurse(req_path, nested_constraint)
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py&#34;, line 361, in _parse_and_recurse
</span></span><span style=display:flex><span>    yield from self._parse_and_recurse(req_path, nested_constraint)
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py&#34;, line 361, in _parse_and_recurse
</span></span><span style=display:flex><span>    yield from self._parse_and_recurse(req_path, nested_constraint)
</span></span><span style=display:flex><span>  [Previous line repeated 974 more times]
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/req/req_file.py&#34;, line 337, in _parse_and_recurse
</span></span><span style=display:flex><span>    for line in self._parse_file(filename, constraint):
</span></span><span style=display:flex><span>[trimmed...]
</span></span><span style=display:flex><span>RecursionError: maximum recursion depth exceeded
</span></span></code></pre></div><p>This example is admittedly a bit contrived, but it can happen if you&rsquo;re referencing
requirement files in a chain and forget what you&rsquo;ve already included. Now, pip will detect
this loop and raise a proper error.</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>pip install -r test.txt
</span></span><span style=display:flex><span>ERROR: /home/ichard26/dev/oss/pip/test.txt recursively references itself in test.txt
</span></span></code></pre></div><p>This was contributed by Kuntal Majumder (@hellozee) in <a href=https://github.com/pypa/pip/pull/12877 target=_blank>PR #12877</a>. ✨</p><p><em>(There was a <a href=https://github.com/pypa/pip/issues/13046 target=_blank>bug where the error would be raised too often</a>, even when no actual
recursion was present. This was promptly addressed in pip 24.3.1.)</em></p><h3 id=installed-packages-with-broken-dependency-metadata-now-raise-a-proper-error>Installed packages with broken dependency metadata now raise a proper error<a hidden class=anchor aria-hidden=true href=#installed-packages-with-broken-dependency-metadata-now-raise-a-proper-error>#</a></h3><p>Since pip 24.1,
<a href=https://pradyunsg.me/blog/2024/05/13/pip-24-1-betas/ target=_blank>non standard-compliant versions or dependency specifiers are unsupported</a>.
While pip will ignore packages with this legacy invalid metadata when possible, in other
cases, the offending package had to be uninstalled to allow pip to function.</p><p>Unfortunately, similar to the issue above, pip would just crash and leave the user a
horrible traceback in these cases.</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>pip install celery
</span></span><span style=display:flex><span>Requirement already satisfied: celery in ./venv/lib/python3.12/site-packages (4.4.7)
</span></span><span style=display:flex><span>ERROR: Exception:
</span></span><span style=display:flex><span>[trimmed...]
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/resolution/resolvelib/candidates.py&#34;, line 401, in iter_dependencies
</span></span><span style=display:flex><span>    for r in self.dist.iter_dependencies():
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/metadata/importlib/_dists.py&#34;, line 215, in iter_dependencies
</span></span><span style=display:flex><span>    req = get_requirement(req_string.strip())
</span></span><span style=display:flex><span>          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_internal/utils/packaging.py&#34;, line 45, in get_requirement
</span></span><span style=display:flex><span>    return Requirement(req_string)
</span></span><span style=display:flex><span>           ^^^^^^^^^^^^^^^^^^^^^^^
</span></span><span style=display:flex><span>  File &#34;/home/ichard26/dev/oss/pip/src/pip/_vendor/packaging/requirements.py&#34;, line 38, in __init__
</span></span><span style=display:flex><span>    raise InvalidRequirement(str(e)) from e
</span></span><span style=display:flex><span>pip._vendor.packaging.requirements.InvalidRequirement: Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier
</span></span><span style=display:flex><span>    pytz (&gt;dev)
</span></span><span style=display:flex><span>         ~^
</span></span></code></pre></div><p>To address this, a new diagnostic error has been added when encountering a broken
pre-installed package.</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>pip install celery
</span></span><span style=display:flex><span>Requirement already satisfied: celery in ./venv/lib/python3.12/site-packages (4.4.7)
</span></span><span style=display:flex><span>error: invalid-installed-package
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>× Cannot process installed package celery 4.4.7 in &#39;/home/ichard26/dev/oss/pip/venv/lib/python3.12/site-packages&#39; because it has an invalid requirement:
</span></span><span style=display:flex><span>│ Expected matching RIGHT_PARENTHESIS for LEFT_PARENTHESIS, after version specifier
</span></span><span style=display:flex><span>│     pytz (&gt;dev)
</span></span><span style=display:flex><span>│               ^
</span></span><span style=display:flex><span>╰─&gt; Starting with pip 24.1, packages with invalid requirements can not be processed.
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>hint: To proceed this package must be uninstalled.
</span></span></code></pre></div><p>Admittedly, the error is a bit hard to read, but with time, pip&rsquo;s errors should improve.
In the interim, you can quickly tell what package is causing the problem (celery) and how
to fix it (uninstall it).</p><h2 id=macos-1012-is-resupported>macOS 10.12 is resupported<a hidden class=anchor aria-hidden=true href=#macos-1012-is-resupported>#</a></h2><p>If you&rsquo;re part of the tiny group that still uses modern pip on macOS 10.12, you would&rsquo;ve
learned first-hand that truststore did not support macOS 10.12, <a href=https://github.com/pypa/pip/issues/12901 target=_blank>breaking pip</a>.
Good news though, pip 24.3 restores support by vendoring in an updated version of
<code>truststore</code> that uses older macOS APIs when needed.</p><p>This brings the pip project one step closer to being able to use system HTTPS certificates
when possible, all without blowing up in odd situations. There are still
<a href=https://github.com/pypa/pip/pull/12918 target=_blank>some known issues with private certificates</a>, however.</p><h2 id=invalid-wheel-filenames-are-deprecated>Invalid wheel filenames are deprecated<a hidden class=anchor aria-hidden=true href=#invalid-wheel-filenames-are-deprecated>#</a></h2><blockquote><p><strong>Note:</strong> Unless you use ancient packages before the advent of modern packaging tooling
AND are incredibly unlucky, this deprecation will NOT affect you. This is mostly for
those interested in the packaging nitty gritty.</p></blockquote><p>If you have any sort of familiarity with Python packaging, you&rsquo;d have heard of wheels.
Wheels are a binary distribution format for Python packages. They are pre-built, which
makes installing them particularly easy: just unzip them and copy the contents to the
<code>site-packages</code> directory.<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><p>Something you might not know is that
<a href=https://packaging.python.org/en/latest/specifications/binary-distribution-format/#file-name-convention target=_blank>their filenames follow a certain structure</a>. This enables installers to
extract essential metadata without inspecting the wheel&rsquo;s contents. As an example, let&rsquo;s
take a look at the newest wheel for pip.</p><pre tabindex=0><code>pip-24.3.1-py3-none-any.whl
</code></pre><p>Here, we know three pieces of information immediately:</p><ul><li><code>pip</code> is the package name</li><li><code>24.3.1</code> is the version</li><li><code>py3-none-any</code> is the compatibility tag.
<a href=/blog/2024/08/whats-new-in-pip-24.2/#pip-check-just-got-a-bit-stricter>I went over compatibility tags in my previous pip write-up</a>, but
essentially, <code>py3-none-any</code> is code for this package supports “any Python 3 version”,
“any Python ABI”, and “any architecture.”</li></ul><p>Unfortunately, some wheels out in the wild have improper names, such as:</p><ul><li><code>translate_toolkit-1.9.0_pinterest3-py27-none-any.whl</code></li><li><code>j2cli-0.3.0_1-py2-none-any.whl</code></li><li><code>password_strength-0.0.1_1-py2-none-any.whl</code></li></ul><p>According to the <a href=https://packaging.python.org/en/latest/specifications/version-specifiers/#implicit-post-releases target=_blank>version specifier standard</a>, underscores can be used to separate the
release segment from any pre/post/development release segments. However, they cannot be
used to separate an implicit post-release.</p><p>In other words, <code>1.2.0_post1</code> (explicit) is valid, but <code>1.2.0_1</code> (implicit) is
not.<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><p>For historical reasons, pip has accepted wheels with this error. This is inconsistent and
confusing, thus starting with pip 24.3, these wheels are no longer supported.</p><p>Frankly, virtually no packages today have this issue, so you can forget this deprecation
even exists<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>, but it is a perfect opportunity to learn about the
complexity found in Python packaging. Many things may look easy in packaging, but often
they are not :)</p><h2 id=other-changes>Other changes<a hidden class=anchor aria-hidden=true href=#other-changes>#</a></h2><ul><li>iOS wheels are provisionally supported: pip will now recognize and accept iOS tagged
wheels, although whether pip properly supports them is something I don&rsquo;t know.</li><li>Installing pip in editable mode in a virtual environment on Windows doesn&rsquo;t result in a
<a href=https://github.com/pypa/pip/issues/12666 target=_blank>data race crash anymore</a></li><li>The <code>--target</code> option is ignored while pip prepares a build environment during
installation, which often caused <a href=https://github.com/pypa/pip/issues/8438 target=_blank>confusing crashes</a> when it was configured globally in
a pip configuration file or via the <code>PIP_TARGET</code> environment variable.</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Of course, it&rsquo;s not this simple in reality, but there is no &ldquo;build step&rdquo; involved
which makes them trivial compared to source distributions (typically .tar.gz).&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>To declare a post-release without the <code>post</code> prefix, you must use the <code>-</code> separator,
e.g. <code>1.2.0-1</code>. Naturally, this raises the question of what to do when this version is
placed in the wheel filename as dashes are reserved as wheel filename separators. The
answer is that the version should be normalized when placed in a wheel filename, and
fortunately for us, <code>1.2.0-1</code> normalizes to <code>1.2.0.post1</code>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://github.com/pypa/pip/pull/12918 target=_blank>While reviewing the deprecation PR</a>, I scraped the index pages for the top
8000 PyPI packages and could only find 4 ancient wheels that have this quirk in their
filename.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://ichard26.github.io/tags/pip/>Pip</a></li><li><a href=https://ichard26.github.io/tags/release/>Release</a></li></ul><nav class=paginav><a class=prev href=https://ichard26.github.io/blog/2025/01/whats-new-in-pip-25.0/><span class=title>« Newer</span><br><span>What's new in pip 25.0</span>
</a><a class=next href=https://ichard26.github.io/blog/2024/08/whats-new-in-pip-24.2/><span class=title>Older »</span><br><span>What's new in pip 24.2 — or why legacy editable installs are deprecated</span></a></nav></footer></article></main><footer class=footer><span>© 2022-present, Richard Si</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>